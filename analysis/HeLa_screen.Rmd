---
title: "HeLa screen"
output: pdf_document
---

```{r HeLa_setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, dev = 'png')
knitr::opts_chunk$set(fig.path = "../figures/")

source(here::here('./style/thesis_setup.R'))

library(here)
library(readbitmap)
library(reshape2)
library(patchwork)
```

```{r HeLa_read_in_images}
SURF4 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/SURF4_grid.png")))
SEC31A = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/SEC31A_grid.png")))
ERGIC53 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/ERGIC53_grid.png")))
MIA3 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/MIA3_grid.png")))
BCAP31 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/BCAP31_grid.png")))
  
ACSL3 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/ACSL3_grid.png")))
BODIPYceramide = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/C5-ceramide_grid.png")))
GS28 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/GS28_grid.png")))
GLG1 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/GLG1_grid.png")))
USO1 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/USO1_grid.png")))
  
LC3 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/LC3_grid.png")))
SLC38A1 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/SLC38A1_grid.png")))
Rab11 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/RAB11_grid.png")))
LAMP1 = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/LAMP1_grid.png")))
mTOR = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/mTOR_grid.png")))

```


```{r HeLa_screen_grid, fig.width = 16, fig.height = 26.6, fig.path = "../figures/full/", eval = FALSE}
layout = 'AFK
          BGL
          CHM
          DIN
          EJO'

#cowplot::plot_grid(SURF4, SEC31A, ERGIC53, MIA3, BCAP31, ACSL3, BODIPYceramide, GS28, GLG1, USO1, LC3, SLC38A1, Rab11, LAMP1, mTOR, ncol = 3, nrow = 5, labels = 'AUTO', byrow = FALSE)
SURF4 + SEC31A + ERGIC53 + MIA3 + BCAP31 + ACSL3 + BODIPYceramide + GS28 + GLG1 + USO1 + LC3 + SLC38A1 + Rab11 + LAMP1 + mTOR +
  plot_layout(design = layout) & plot_annotation(tag_levels = 'A')
```

```{r ERES_grid, fig.width=16, fig.height=16, fig.path = "../figures/full/"}
ERES_grid = BCAP31 + SURF4 + MIA3 + SEC31A + plot_annotation(tag_levels = 'A') + plot_layout(nrow = 2)
```

```{r Golgi_grid, fig.width=16, fig.height=16, fig.path = "../figures/full/"}
Golgi_grid = ERGIC53 + GS28 + GLG1 + USO1 + plot_annotation(tag_levels = 'A') + plot_layout(nrow = 2)
```

```{r misc_grid, fig.width=16, fig.height=16, fig.path = "../figures/full/"}
misc_grid = LAMP1 + mTOR + ACSL3 + SLC38A1 + plot_annotation(tag_levels = 'A') + plot_layout(nrow = 2)
```


```{r HeLa_ceramide_full_figure, fig.width = 16, fig.height = 8, fig.path = "../figures/full/"}
ceramide_profile.csv = read.csv("C:\\Users\\fl299\\PhD\\Data\\Mine\\Confocal\\HeLa14_BODIPY-ceramide_TIFs\\intensity_profiles\\WT3_ceramide.tif_profile.csv")
ceramide_profile.csv.normalised = data.frame(X = ceramide_profile.csv$X,
                                             ch1 = ceramide_profile.csv$Value_ch1/max(ceramide_profile.csv$Value_ch1),
                                             ch2 = ceramide_profile.csv$Value_ch2/max(ceramide_profile.csv$Value_ch2))
ceramide_profile.melt = melt(ceramide_profile.csv.normalised, measure.vars = c('ch1', 'ch2'))

ceramide_profile = ggplot(ceramide_profile.melt, aes(x = X, y = value, group = variable)) + 
  geom_area(aes(fill = variable), alpha = 0.25, position = 'dodge') +
  geom_line(aes(colour = variable), size = 2) +
  labs(y = 'Normalised fluorescence intensity', x = '') +
  d_format + report_theme

grid_panel = image_as_ggplot(read.bitmap(here("images/microscopy/HeLa_montages/C5-ceramide_WT_inset_grid.png")))

ceramide_grid = grid_panel + ceramide_profile + plot_annotation(tag_level = 'A')

ceramide_grid
```
